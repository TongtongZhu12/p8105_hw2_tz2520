---
title: "Homework 2"
author: "Tongtong Zhu"
date: "2022-10-04"
output: github_document
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(collapse = TRUE, message = FALSE, warning = FALSE)
```

```{r load_libraries, include=FALSE}
library(tidyverse)
library(readxl)
```

## Problem 1

### Read and clean the data 

```{r}
trans_ent = 
  read_csv(
    "data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv",
    col_types = cols(Route8 = "c", Route9 = "c", Route10 = "c", Route11 = "c")) %>% 
  janitor::clean_names() %>% 
  select(
    line, station_name, station_latitude, station_longitude, 
    starts_with("route"), entry, exit_only, vending, entrance_type, 
    ada) %>% 
  mutate(entry = ifelse(entry == "YES", TRUE, FALSE))
```

**Description of dataset**

The dataset `trans_ent` contains `r ncol(trans_ent)` columns and `r nrow(trans_ent)` rows. The variables include `line`, `station_name`, `station_latitude`, `station_longitude`, route (1-11), `entry`, `exit_only`, `vending`, `entrance_type`, `ada`. Data cleaning steps begin with data read, clean variable names, change the type of variable of Route columns (8-11) to character, arrange the sequence of columns, change the type of `entry` variable to logical. 

These data are not "tidy", because route number should be a variable. 

### Calculate the number of distinc stations

**Number of distinct stations**

```{r}
trans_ent %>% 
  select(station_name, line) %>% 
  distinct
```

**Number of distinct stations with ADA compliant**

```{r}
trans_ent %>% 
  filter(ada == TRUE) %>% 
  select(station_name, line) %>% 
  distinct
```

**Proportion of station entrances / exits**

```{r}
trans_ent %>% 
  filter(vending == "NO") %>% 
  pull(entry) %>% 
  mean
```

**Number of distinct stations serve A train, with ADA compliant**

```{r}
trans_ent %>% 
  pivot_longer(
    route1:route11,
    names_to = "route_num",
    values_to = "route") %>% 
  filter(route == "A") %>% 
  select(station_name, line) %>% 
  distinct

trans_ent %>% 
  pivot_longer(
    route1:route11,
    names_to = "route_num",
    values_to = "route") %>% 
  filter(route == "A", ada == TRUE) %>% 
  select(station_name, line) %>% 
  distinct
```

**Summary**

There are total 465 distinct stations. 
There are 84 distinct stations with ADA compliant.
37.7% of station entrances/exits without vending allows entrance.
There are 60 distinct stations serve the A train. Of the stations that serve the A train, 17 are ADA compliant.


## Problem 2

### Read and clean Mr. Trash Wheel sheet

```{r}
mr_trash_wheel = 
  read_excel(
    "./data/Trash Wheel Collection Data.xlsx",
    sheet = 1,
    range = "A2:N550",
    skip = 1, 
    col_names = TRUE) %>% 
  janitor::clean_names() %>% 
  drop_na(dumpster) %>% 
  mutate(sports_balls = as.integer(round(sports_balls, digits = 0)))
```

### Read and clean Professor Trash Wheel sheet

```{r}
pro_trash_wheel = 
  read_excel(
    "./data/Trash Wheel Collection Data.xlsx",
    sheet = 2,
    range = "A2:M97",
    skip = 1, 
    col_names = TRUE) %>% 
  janitor::clean_names() %>% 
  drop_na(dumpster) %>% 
  mutate(
    sports_balls = NA,
    year = as.character(year)) %>% 
  relocate(sports_balls, .before = homes_powered)
```



























